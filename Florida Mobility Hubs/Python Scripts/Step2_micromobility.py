# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-08-07 02:37:18
"""
import arcpy

def Model4():  # Model4

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    result1 = "result1"
    gnv_block_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\data\\gnv_block.shp"
    new_stops = "new stops"
    result1_3_ = "result1"
    scooter_merge_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter_merge.shp"
    mcirotransit_merge_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\mcirotransit_merge.shp"

    # Process: Feature To Point (Feature To Point) (management)
    gnv_block_FeatureToPoint1 = "C:\\Users\\anranzheng\\OneDrive - University of Florida\\Documents\\ArcGIS\\Projects\\gnv mobility hub\\gnv mobility hub.gdb\\gnv_block_FeatureToPoint1"
    arcpy.management.FeatureToPoint(in_features=gnv_block_shp, out_feature_class=gnv_block_FeatureToPoint1, point_location="CENTROID")

    # Process: Near (Near) (analysis)
    gnv_block_FeatureToPoint1_3_ = arcpy.analysis.Near(in_features=gnv_block_FeatureToPoint1, near_features=[new_stops], search_radius="", location="NO_LOCATION", angle="NO_ANGLE", method="PLANAR", field_names=[["NEAR_FID", "NEAR_FID"], ["NEAR_DIST", "NEAR_DIST"]])[0]

    # Process: Copy Features (Copy Features) (management)
    nearest_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\nearest.shp"
    arcpy.management.CopyFeatures(in_features=gnv_block_FeatureToPoint1_3_, out_feature_class=nearest_shp, config_keyword="", spatial_grid_1=None, spatial_grid_2=None, spatial_grid_3=None)

    # Process: Spatial Join (Spatial Join) (analysis)
    scooter_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp"
    arcpy.analysis.SpatialJoin(target_features=result1_3_, join_features=scooter_merge_shp, out_feature_class=scooter_shp, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="Route \"Route\" true true false 24 Double 15 23,First,#,result1,Route,-1,-1;total_trip \"total_trip\" true true false 24 Double 15 23,First,#,result1,total_trip,-1,-1;Total_Acti \"Total_Acti\" true true false 24 Double 15 23,First,#,result1,Total_Acti,-1,-1;W_C_TOTAL \"W_C_TOTAL\" true true false 24 Double 15 23,First,#,result1,W_C_TOTAL,-1,-1;BIKE_TOTAL \"BIKE_TOTAL\" true true false 24 Double 15 23,First,#,result1,BIKE_TOTAL,-1,-1;index \"index\" true true false 18 Double 0 18,First,#,result1,index,-1,-1;lat \"lat\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter_merge.shp,lat,-1,-1;lon \"lon\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter_merge.shp,lon,-1,-1", match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Spatial Join (2) (Spatial Join) (analysis)
    transit_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\transit.shp"
    arcpy.analysis.SpatialJoin(target_features=scooter_shp, join_features=mcirotransit_merge_shp, out_feature_class=transit_shp, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="Join_Count \"Join_Count\" true true false 0 Long 0 0,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,Join_Count,-1,-1;TARGET_FID \"TARGET_FID\" true true false 0 Long 0 0,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,TARGET_FID,-1,-1;Route \"Route\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,Route,-1,-1;total_trip \"total_trip\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,total_trip,-1,-1;Total_Acti \"Total_Acti\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,Total_Acti,-1,-1;W_C_TOTAL \"W_C_TOTAL\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,W_C_TOTAL,-1,-1;BIKE_TOTAL \"BIKE_TOTAL\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,BIKE_TOTAL,-1,-1;index \"index\" true true false 18 Double 0 18,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,index,-1,-1;lat \"lat\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,lat,-1,-1;lon \"lon\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\scooter.shp,lon,-1,-1;lat \"lat\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\mcirotransit_merge.shp,lat,-1,-1;lon \"lon\" true true false 24 Double 15 23,First,#,C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\mcirotransit_merge.shp,lon,-1,-1", match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Intersect (Intersect) (analysis)
    fmlm_score_shp = "C:\\Users\\anranzheng\\Dropbox (UFL)\\Mobility Hub\\Anran\\module builder\\process\\fmlm_score.shp"
    arcpy.analysis.Intersect(in_features=[[nearest_shp, ""], [transit_shp, ""]], out_feature_class=fmlm_score_shp, join_attributes="ALL", cluster_tolerance="", output_type="INPUT")

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"C:\Users\anranzheng\OneDrive - University of Florida\Documents\ArcGIS\Projects\gnv mobility hub\gnv mobility hub.gdb", workspace=r"C:\Users\anranzheng\OneDrive - University of Florida\Documents\ArcGIS\Projects\gnv mobility hub\gnv mobility hub.gdb"):
        Model4()
